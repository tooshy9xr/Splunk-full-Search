# ğŸ§  Fileless Malware Patterns  
Advanced Memory-Only & Script-Based Attack Detection  
(Windows â€¢ Linux â€¢ Cloud)

---

## ğŸ“ Folder Context (Professional Description)

The **Fileless Malware Patterns** module focuses on detecting **malicious activity that does not rely on traditional executable files**.  
Instead, attackers execute payloads directly in **memory**, through **scripts, interpreters, registry, WMI, or legitimate system tools**.

Fileless techniques are common in **advanced persistent threats (APT)** and are specifically designed to **evade antivirus and disk-based detection**.

---

## ğŸ¯ File Objective

`Fileless-malware-patterns.md` is designed to:
- Detect **memory-resident attacks**
- Identify **script-based and reflective execution**
- Correlate execution, authentication, and network behavior
- Support advanced threat hunting and IR operations
- Reduce reliance on file-hash-based detection

---

## ğŸ§© Threat Context

Mapped to **MITRE ATT&CK**:
- T1059 â€“ Command and Scripting Interpreter  
- T1027 â€“ Obfuscated / Encrypted Payloads  
- T1106 â€“ Native API  
- T1218 â€“ Signed Binary Proxy Execution  
- TA0002 â€“ Execution  

Attackers often:
- Avoid writing files to disk
- Abuse PowerShell, WMI, Bash, Python
- Load payloads directly into memory
- Execute via encoded or obfuscated commands

---

## ğŸ“Š Data Sources

| Source | Description |
|------|------------|
| PowerShell Logs | Script block & module logging |
| Windows Security Logs | EventID 4688 |
| Sysmon | Process & memory activity |
| Linux Audit Logs | Shell execution |
| EDR Telemetry | Memory & behavior analytics |
| Cloud VM Logs | Run-command & API execution |

---

## ğŸ” Advanced Detection Patterns (18 Scenarios)

---

### ğŸªŸ Windows Fileless Techniques

### 1ï¸âƒ£ Encoded PowerShell Execution
```spl
process="powershell.exe" command="*-enc*"
```
ğŸ“Œ Obfuscated memory execution.

---

### 2ï¸âƒ£ PowerShell Download-Execute
```spl
command="*IEX*" OR command="*Invoke-Expression*"
```
ğŸ“Œ Script execution without files.

---

### 3ï¸âƒ£ Reflective DLL Loading
```spl
process="rundll32.exe"
```
ğŸ“Œ In-memory DLL execution.

---

### 4ï¸âƒ£ WMI Command Execution
```spl
process="wmic.exe"
```
ğŸ“Œ Remote and fileless execution.

---

### 5ï¸âƒ£ Registry-Based Payloads
```spl
registry_path="*Run*"
```
ğŸ“Œ Persistence without binaries.

---

---

### ğŸ§ Linux Fileless Techniques

### 6ï¸âƒ£ Bash Pipe Execution
```spl
command="*|bash*"
```
ğŸ“Œ Streaming execution from network.

---

### 7ï¸âƒ£ Curl / Wget to Interpreter
```spl
command="*curl*" AND command="*bash*"
```
ğŸ“Œ No-disk execution chain.

---

### 8ï¸âƒ£ In-Memory Python Execution
```spl
process="python"
```
ğŸ“Œ Script-based payloads.

---

### 9ï¸âƒ£ Base64 Decode & Execute
```spl
command="*base64*"
```
ğŸ“Œ Obfuscation.

---

---

### â˜ï¸ Cloud & Cross-Platform

### ğŸ”Ÿ Cloud VM Run-Command Abuse
```spl
index=cloud_vm action=execute
```
ğŸ“Œ Fileless remote execution.

---

### 1ï¸âƒ£1ï¸âƒ£ Script Execution via API Tokens
```spl
auth_method="token"
```
ğŸ“Œ Automation abuse.

---

### 1ï¸âƒ£2ï¸âƒ£ Fileless Execution After Login
```spl
| transaction user maxspan=5m
```
ğŸ“Œ Post-compromise behavior.

---

### 1ï¸âƒ£3ï¸âƒ£ Script Execution from Temp Memory Paths
```spl
command="*/dev/shm/*"
```
ğŸ“Œ Linux shared memory abuse.

---

### 1ï¸âƒ£4ï¸âƒ£ Fileless Activity with Network Beaconing
```spl
| transaction process maxspan=2m
```
ğŸ“Œ Command + outbound traffic.

---

### 1ï¸âƒ£5ï¸âƒ£ Repeated Script Execution Patterns
```spl
| stats count by user command
| where count > 10
```
ğŸ“Œ Persistence behavior.

---

### 1ï¸âƒ£6ï¸âƒ£ PowerShell Without Parent Process
```spl
parent_process!="explorer.exe"
```
ğŸ“Œ Suspicious execution chain.

---

### 1ï¸âƒ£7ï¸âƒ£ Script Execution with Elevated Privileges
```spl
integrity_level="High"
```
ğŸ“Œ Privilege escalation indicator.

---

### 1ï¸âƒ£8ï¸âƒ£ Rare Script Usage
```spl
| stats count by user process
| where count < 3
```
ğŸ“Œ Behavioral anomaly.

---

## ğŸ§  Behavioral Indicators Summary
- No file creation events
- Script interpreters and LOLBins
- Encoded or obfuscated commands
- Network activity after execution
- Memory-only payload behavior
- Privilege misuse

---

## ğŸ›¡ï¸ Response & Mitigation
- Enable PowerShell Script Block Logging
- Monitor memory and parent-child processes
- Restrict interpreter usage
- Apply AMSI and EDR protections
- Correlate with authentication and network logs

---

## ğŸ“Œ Final Summary

This module delivers **advanced detection of fileless malware patterns** across:
- ğŸªŸ Windows
- ğŸ§ Linux
- â˜ï¸ Cloud environments

It is a **critical capability for modern SOCs**, addressing **evasion-focused, memory-resident attacks**.


