# ğŸªŸ Windows â€” Malware Detection
## ğŸ”¹ Suspicious Executables
Description: Detects unusual .exe, .dll, .bat files commonly linked to malware. <br> 
Purpose: Helps reveal suspicious or newly dropped executables.

ğŸ” SPL
```
index=windows (Image="*.exe" OR Image="*.dll" OR Image="*.bat")
| stats count by Image, User, Computer, _time
```
## ğŸ”¹ Windows Defender Alerts

Description: Returns alerts generated by Windows Defender.<br>
Purpose: Identifies confirmed or suspected malware activity.

ğŸ” SPL
```
index=windows sourcetype="WinEventLog:Microsoft-Windows-Windows Defender/Operational"
| stats count by ThreatName, Severity, FilePath, User, _time
```
## ğŸ”¹ Suspicious Processes
Description: Detects malicious process chains (Office â†’ cmd, PowerShell, etc.). <br>
Purpose: Helps identify macro-based attacks and phishing payloads.

ğŸ” SPL
```
index=windows EventCode=4688
| search (ParentImage="*word*" OR ParentImage="*excel*" OR ParentImage="*outlook*")
| stats count by ParentImage, NewProcessName, User, _time
```
## ğŸ”¹ Malware Hash Indicators
Description: Checks file hashes against threat intelligence lists.<br>
Purpose: Detects known malware variants.

ğŸ” SPL
```
index=windows file_hash=*
| lookup malware_hashes hash AS file_hash OUTPUT threat_type
| search threat_type=*
| stats count by FileName, file_hash, threat_type, host
```
## ğŸ”¹ Reverse Shell Activity
Description: Finds suspicious outbound connections created by cmd.exe or PowerShell.
Purpose: Helps detect backdoor communications.

ğŸ” SPL
```
index=windows (Image="*cmd.exe" OR Image="*powershell.exe")
| search dest_port IN (53, 80, 443, 8080)
| stats count by User, Image, dest, dest_port, _time
```
## ğŸ”¹ Malicious Downloads (PowerShell)
Description: Detects PowerShell download commands (Invoke-WebRequest, iwr).
Purpose: Used heavily by malware droppers.

ğŸ” SPL
```
index=windows CommandLine="*Invoke-WebRequest*" OR CommandLine="*wget*" OR CommandLine="*iwr*"
| stats count by User, CommandLine, Computer, _time
```
# ğŸ§ Linux â€” Malware Detection
## ğŸ”¹ Suspicious Executables in Temp Paths
Description: Detects binaries executed from /tmp, /dev/shm, or writable folders.
Purpose: Common malware persistence technique.

ğŸ” SPL
```
index=linux (exe="/tmp/*" OR exe="/dev/shm/*")
| stats count by exe, user, host, _time
```
## ğŸ”¹ Malicious Downloads
Description: Flags files downloaded using wget or curl.
Purpose: Malware often enters through command-line downloaders.

ğŸ” SPL
```
index=linux (process="wget" OR process="curl")
| stats count by user, host, cmdline, _time
```
## ğŸ”¹ Suspicious Processes
Description: Detects network tools commonly used by attackers.
Purpose: Helps identify reconnaissance or lateral movement.

ğŸ” SPL
```
index=linux process IN ("nmap","nc","netcat","tcpdump")
| stats count by process, user, host, _time
```
## ğŸ”¹ Reverse Shell Activity
Description: Identifies classic Linux reverse shell commands.
Purpose: Detects remote backdoor communication attempts.

ğŸ” SPL
```
index=linux (cmdline="*bash -i >& /dev/tcp/*" OR cmdline="*nc * -e*" OR cmdline="*/dev/tcp/*")
| stats count by user, host, cmdline, _time
```
## ğŸ”¹ Crypto-Miner Indicators
Description: Detects unusually high CPU usage by unknown processes.
Purpose: Helps discover cryptomining malware.

ğŸ” SPL
```
index=linux sourcetype=process cpu>80
| stats max(cpu) by process, user, host
```
